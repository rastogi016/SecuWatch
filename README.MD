# ğŸ›¡ï¸ SecuWatch: Threat Detection & Response Framework (v1.0)

**SecuWatch** is a full-stack cybersecurity tool for real-time log analysis, threat detection, and alert visualization. It integrates **FastAPI** (backend), **React + Tailwind CSS** (frontend), and **WebSockets** for live alert streaming. It supports authentication, CTI enrichment, and analytics dashboards â€” all in one lightweight solution.

![Login Page](assets/Login_Page.png)

![Dashboard](assets/Dashboard.png)

![Analytics Tab](assets/Analytics.png)

![Apache Alerts](assets/Apache.png)

![Windows Alerts](assets/Windows.png)

![Linux Alerts](assets/Linux.png)

---

## ğŸ“ Project Structure

```
SecuWatch/
â”œâ”€â”€ alert_handler/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ alert_writer.py          # Writes alerts & broadcasts to WebSocket
â”‚
â”œâ”€â”€ alerts/
â”‚   â”œâ”€â”€ apache/                  # Apache-generated alerts
â”‚   â”œâ”€â”€ linux/                   # Linux-generated alerts
â”‚   â””â”€â”€ windows/                 # Windows-generated alerts
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ App.py                   # FastAPI WebSocket + REST API
â”‚   â”œâ”€â”€ alerts_handler.py        # Alert source grouping logic
â”‚   â”œâ”€â”€ ws_instance.py           # Shared WebSocket manager instance
â”‚   â”œâ”€â”€ websocket_manager.py     # Manages WebSocket connections
â”‚   â”œâ”€â”€ db.py                    # SQLite DB setup
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ ...                  # Auth-related files (JWT, hashing, etc.)
â”‚
â”œâ”€â”€ cti_module/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ .env                     # API keys (AbuseIPDB, VirusTotal)
â”‚   â”œâ”€â”€ config.py                # Loads env vars
â”‚   â”œâ”€â”€ cti_lookup.py            # CTI enrichment (IP, hash, URL)
â”‚   â””â”€â”€ test_cti_lookup.py       # Unit test for CTI functions
â”‚
â”œâ”€â”€ custom_fields/
â”‚   â””â”€â”€ severity.py              # Defines severity levels
â”‚
â”œâ”€â”€ detectors/
â”‚   â”œâ”€â”€ apache_detector.py       # Detects suspicious Apache events
â”‚   â”œâ”€â”€ linux_detector.py        # Detects Linux auth anomalies
â”‚   â””â”€â”€ windows_detector.py      # Detects Windows log anomalies
â”‚
â”œâ”€â”€ log_collectors/
â”‚   â”œâ”€â”€ apache_collector.py          # Static Apache log collector
â”‚   â”œâ”€â”€ apache_realtime_monitor.py   # Realtime Apache log monitor
â”‚   â”œâ”€â”€ linux_collector.py           # Static Linux log collector
â”‚   â”œâ”€â”€ linux_realtime_monitor.py    # Realtime Linux log monitor
â”‚   â”œâ”€â”€ windows_collector.py         # Static Windows log collector
â”‚   â””â”€â”€ windows_realtime_monitor.py  # Realtime Windows log monitor
â”‚
â”œâ”€â”€ sample_logs/                 # Folder for test log files
â”‚   â””â”€â”€ ...                      # Example: linux_auth.log
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ time_config.py           # Time utilities or formatting
â”‚
â”œâ”€â”€ additional/
â”‚   â””â”€â”€ banner.py                # Terminal banner on startup
â”‚
â”œâ”€â”€ frontend/                    # React + Tailwind frontend
â”‚   â””â”€â”€ ...                      # Pages: Dashboard, Login, Signup, etc.
â”‚
â”œâ”€â”€ secuwatch.db                 # SQLite database (users, etc.)
â”œâ”€â”€ install.py                   # Setup script
â”œâ”€â”€ main.py                      # Starts static/realtime log analysis
â”œâ”€â”€ requirements.txt             # Python backend dependencies 
â””â”€â”€ README.md

```

---

## ğŸš€ Features

-  Real-time and Static alert detection and delivery
-  WebSocket-based live feed
-  Analytics with charts (Recharts)
-  Central dashboard (Apache, Windows, Linux)
-  User authentication via SQLite + JWT
-  CTI integration ready (VirusTotal, AbuseIPDB)
-  Fully automatable with setup scripts

---

## âš™ï¸ Prerequisites

- **Python** 3.9+
- **Node.js** v16+
- **virtualenv** installed:
  ```bash
  pip install virtualenv
  ```

---

## ğŸ§ª Setup Instructions

### 1ï¸âƒ£ Clone the repository

```bash
git clone https://github.com/rastogi016/SecuWatch.git
cd SecuWatch
```

### 2ï¸âƒ£ Run Setup Script (Auto installs backend + frontend)

  ```bash
  python install.py
  ```

> If using the Python version, it checks for `virtualenv` and Node.js before installing dependencies.

---

## ğŸš¦ Launch the Application with Three Terminals

- Start backend only:
  ```bash
  uvicorn backend.App:app --reload
  ```

- Start frontend only:
  ```bash
  cd frontend
  npm run dev
  ```

- Run main engine:
  ```bash
  python main.py
  ```
## For Windows 
- Need Administrative Privilege

You will see:
- ğŸ” `main.py` (log monitoring engine)
- ğŸŒ FastAPI backend â†’ `http://localhost:8000`
- âš›ï¸ React frontend â†’ `http://localhost:5173` (or next free port)

---

## ğŸ‘¤ Authentication

- First screen: **Login / Signup**
- Users stored in `secuwatch.db`
- Passwords hashed (bcrypt)
- JWT token stored in `localStorage`

---

## ğŸ“Š Dashboard & Analytics

-  Real-time Alerts by Source
-  Alerts Timeline Chart
-  Top IPs / URLs / Hashes
-  Severity Breakdown (low/medium/high)

---

## ğŸ”§ Environment Variables (optional CTI)

To use VirusTotal or AbuseIPDB:

Create a `.env` file in root:
```
ABUSEIPDB_API_KEY=your_api_key
VT_API_KEY=your_api_key
```

---

## ğŸ› ï¸ Development Scripts

- Start backend only:
  ```bash
  uvicorn backend.App:app --reload
  ```

- Start frontend only:
  ```bash
  cd frontend
  npm run dev
  ```

- Run main engine:
  ```bash
  python main.py
  ```

---

## ğŸ§¹ To-Do (Future Enhancements)

-  Integrate machine learning for anomaly detection
-  Dockerize frontend/backend
-  Email or webhook notifications
-  And Many More.....

---

## ğŸªª License

MIT License Â© Threat Sage

---

## ğŸ§  Author

**Yash Rastogi**  
[LinkedIn](https://www.linkedin.com/in/yashrastogi11) Â· [GitHub](https://github.com/rastogi016)

---

## â˜ï¸ Deploy (Vercel + Backend Host)

Because the backend uses FastAPI WebSockets, deploy the frontend on Vercel and the backend on a host that supports long-lived connections (Render, Railway, Fly.io, etc.).

1) Backend (Render/Railway)
- Create a new Web Service from this repo.
- Runtime: Python 3.11+. Start command:
  ```bash
  uvicorn backend.App:app --host 0.0.0.0 --port $PORT
  ```
- Env vars: set `MONGODB_URI` and any CTI keys.
- Expose port: use platform-provided `$PORT`.

Optional (Railway): add a `Procfile` with: `web: uvicorn backend.App:app --host 0.0.0.0 --port $PORT`.

2) Frontend (Vercel)
- Project root: `frontend/`
- Build Command: `npm run build`
- Output Directory: `dist`
- Env vars (Project â†’ Settings â†’ Environment Variables):
  - `VITE_API_BASE_URL` â†’ e.g. `https://<your-backend-host>`
  - `VITE_WS_URL` â†’ e.g. `wss://<your-backend-host>/ws/alerts`

3) Local env
- See `frontend/.env.example`. For local dev create `frontend/.env` or `.env.local`:
  ```
  VITE_API_BASE_URL=http://localhost:8000
  VITE_WS_URL=ws://localhost:8000/ws/alerts
  ```

4) Frontend API/WS are already parameterized to use these variables and fall back to localhost when not set.
